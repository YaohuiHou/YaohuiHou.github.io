(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{323:function(t,s,a){"use strict";a.r(s);var n=a(1),o=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h2",{attrs:{id:"_02-js运行机制：异步和单线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_02-js运行机制：异步和单线程","aria-hidden":"true"}},[t._v("#")]),t._v(" 02.js运行机制：异步和单线程")]),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[t._v("#")]),t._v(" 前言")]),a("p",[t._v("面试时，关于"),a("code",[t._v("同步和异步")]),t._v("，可能会问以下问题：")]),a("ul",[a("li",[a("p",[t._v("同步和异步的区别是什么？分别举一个同步和异步的例子")])]),a("li",[a("p",[t._v("一个关于 setTimeout 的笔试题")])]),a("li",[a("p",[t._v("前端使用异步的场景哪些？")])])]),a("p",[t._v("面试时，关于"),a("code",[t._v("js运行机制")]),t._v("，需要注意以下几个问题：")]),a("ul",[a("li",[a("p",[t._v("如何理解JS的"),a("strong",[t._v("单线程")])])]),a("li",[a("p",[t._v("什么是"),a("strong",[t._v("任务队列")])])]),a("li",[a("p",[t._v("什么是 EventLoop")])]),a("li",[a("p",[t._v("理解哪些语句会放入异步任务队列")])]),a("li",[a("p",[t._v("理解语句放入异步任务队列的"),a("strong",[t._v("时机")])])])]),a("h2",{attrs:{id:"js的异步和单线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js的异步和单线程","aria-hidden":"true"}},[t._v("#")]),t._v(" JS的异步和单线程")]),a("blockquote",[a("p",[t._v("因为是单线程，所以必须异步。")])]),a("p",[t._v("我们通过题目来解释以下。")]),a("h3",{attrs:{id:"题目一：异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#题目一：异步","aria-hidden":"true"}},[t._v("#")]),t._v(" 题目一：异步")]),a("p",[t._v("现有如下代码：")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("4")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])]),a("p",[t._v("上面的代码中，我们很容易知道，打印的顺序是"),a("code",[t._v("1，3，4，2")]),t._v("。因为你会想到，要等一秒之后再打印"),a("code",[t._v("2")]),t._v("。")]),a("p",[t._v("可如果我把延时的时间从"),a("code",[t._v("1000")]),t._v("改成"),a("code",[t._v("0")]),t._v("：")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("4")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("p",[t._v("上方代码中，打印的顺序仍然是"),a("code",[t._v("1，3，4，2")]),t._v("。这是为什么呢？我们来分析一下。")]),a("p",[a("strong",[t._v("总结：")])]),a("p",[t._v("js 是单线程（同一时间只能做一件事），而且有一个"),a("strong",[t._v("任务队列")]),t._v("：全部的同步任务执行完毕后，再来执行异步任务。第一行代码和最后一行代码是同步任务；但是，"),a("strong",[a("code",[t._v("setTimeout")]),t._v("是异步任务")]),t._v("。")]),a("p",[t._v("于是，执行的顺序是：")]),a("ul",[a("li",[a("p",[t._v("先执行同步任务"),a("code",[t._v("console.log(1)")])])]),a("li",[a("p",[t._v("遇到异步任务"),a("code",[t._v("setTimeout")]),t._v("，要"),a("strong",[t._v("挂起")])])]),a("li",[a("p",[t._v("执行同步任务"),a("code",[t._v("console.log(3)")])])]),a("li",[a("p",[a("strong",[t._v("全部的同步任务执行完毕后，再来执行异步任务")]),a("code",[t._v("console.log(2)")]),t._v("。")])])]),a("p",[t._v("很多人会把这个题目答错，这是因为他们不懂 js 的运行机制。")]),a("p",[t._v("注意上面那句话：同步任务执行完毕后，再来执行异步任务。也就是说，"),a("strong",[t._v("如果同步任务没有执行完，异步任务是不会执行的")]),t._v("。为了解释这句话，我们来看下面这个例子。")]),a("h3",{attrs:{id:"题目二：异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#题目二：异步","aria-hidden":"true"}},[t._v("#")]),t._v(" 题目二：异步")]),a("p",[t._v("现有如下代码：")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'A'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'B'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("p",[t._v("我们很容易想到，上方代码的打印结果是"),a("code",[t._v("A")]),t._v("，因为while是同步任务，代码会陷入死循环里出不来，自然也就无法打印"),a("code",[t._v("B")]),t._v("。可如果我把代码改成下面的样子：")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'A'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'B'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),a("p",[t._v("上方代码的打印结果仍然是"),a("code",[t._v("A")]),t._v("。因为while是同步任务，setTimeout是异步任务，所以还是那句话："),a("strong",[t._v("如果同步任务没有执行完，队列里的异步任务是不会执行的")]),t._v("。")]),a("h3",{attrs:{id:"题目三：同步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#题目三：同步","aria-hidden":"true"}},[t._v("#")]),t._v(" 题目三：同步")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'A'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{attrs:{class:"token function"}},[t._v("alert")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'haha'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("//1秒之后点击确认")]),t._v("\n\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'B'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])]),a("p",[a("code",[t._v("alert")]),t._v("函数是同步任务，我只有点击了确认，才会继续打印"),a("code",[t._v("B")]),t._v("。")]),a("h3",{attrs:{id:"同步和异步的对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同步和异步的对比","aria-hidden":"true"}},[t._v("#")]),t._v(" 同步和异步的对比")]),a("p",[t._v("我们在上面列举了异步和同步的例子。现在来描述一下区别：【重要】")]),a("p",[t._v("因为"),a("code",[t._v("setTimeout")]),t._v("是"),a("strong",[t._v("异步任务")]),t._v("，所以程序并不会卡在那里，而是继续向下执行（即使settimeout设置了倒计时一万秒）；但是"),a("code",[t._v("alert")]),t._v("函数是"),a("strong",[t._v("同步")]),t._v("任务，程序会"),a("strong",[t._v("卡在那里")]),t._v("，如果它没有执行，后面的也不会执行（卡在那里，自然也就造成了"),a("strong",[t._v("阻塞")]),t._v("）。")]),a("h3",{attrs:{id:"前端使用异步的场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端使用异步的场景","aria-hidden":"true"}},[t._v("#")]),t._v(" 前端使用异步的场景")]),a("p",[t._v("什么时候需要"),a("strong",[t._v("等待")]),t._v("，就什么时候用异步。")]),a("ul",[a("li",[a("p",[t._v("定时任务：setTimeout（定时炸弹）、setInterval（循环执行）")])]),a("li",[a("p",[t._v("网络请求：ajax请求、动态"),a("code",[t._v("<img>")]),t._v("加载")])]),a("li",[a("p",[t._v("事件绑定（比如说，按钮绑定点击事件之后，用户爱点不点。我们不可能卡在按钮那里，什么都不做。所以，应该用异步）")])]),a("li",[a("p",[t._v("ES6中的Promise")])])]),a("p",[t._v("代码举例：")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'start'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" img "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("createElement")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'img'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    img"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'loaded'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    img"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'/xxx.png'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'end'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("p",[t._v("上图中，先打印"),a("code",[t._v("start")]),t._v("，然后执行"),a("code",[t._v("img.src = '/xxx.png'")]),t._v("，然后打印"),a("code",[t._v("end")]),t._v("，最后打印"),a("code",[t._v("loaded")]),t._v("。")]),a("h2",{attrs:{id:"任务队列和event-loop（事件循环）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务队列和event-loop（事件循环）","aria-hidden":"true"}},[t._v("#")]),t._v(" 任务队列和Event Loop（事件循环）")]),a("h3",{attrs:{id:"任务队列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务队列","aria-hidden":"true"}},[t._v("#")]),t._v(" 任务队列")]),a("p",[t._v('所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务。异步任务指的是，不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。')]),a("p",[t._v("总结："),a("strong",[t._v('只要主线程空了，就会去读取"任务队列"，这就是JavaScript的运行机制')]),t._v("。【重要】")]),a("h3",{attrs:{id:"event-loop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-loop","aria-hidden":"true"}},[t._v("#")]),t._v(" Event Loop")]),a("p",[t._v('主线程从"任务队列"中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop（事件循环）。')]),a("p",[a("img",{attrs:{src:"http://img.smyhvae.com/20180310_1840.png",alt:""}})]),a("p",[t._v("在理解Event Loop时，要理解两句话：")]),a("ul",[a("li",[a("p",[t._v("理解哪些语句会放入异步任务队列")])]),a("li",[a("p",[t._v("理解语句放入异步任务队列的"),a("strong",[t._v("时机")])])])]),a("h3",{attrs:{id:"容易答错的题目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容易答错的题目","aria-hidden":"true"}},[t._v("#")]),t._v(" 容易答错的题目")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{attrs:{class:"token operator"}},[t._v("++")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("p",[t._v("很多人以为上面的题目，答案是"),a("code",[t._v("0,1,2,3")]),t._v("。其实，正确的答案是："),a("code",[t._v("3,3,3,3")]),t._v("。")]),a("p",[t._v("分析：for 循环是同步任务，setTimeout是异步任务。for循环每次遍历的时候，遇到settimeout，就先暂留着，等同步任务全部执行完毕（此时，i已经等于3了），再执行异步任务。")]),a("p",[t._v("我们把上面的题目再加一行代码。最终代码如下：")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{attrs:{class:"token operator"}},[t._v("++")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("p",[t._v("如果我们约定，用箭头表示其前后的两次输出之间有 1 秒的时间间隔，而逗号表示其前后的两次输出之间的时间间隔可以忽略，代码实际运行的结果该如何描述？可能会有两种答案：")]),a("ul",[a("li",[a("p",[t._v("A. 60% 的人会描述为："),a("code",[t._v("3 -> 3 -> 3 -> 3")]),t._v("，即每个 3 之间都有 1 秒的时间间隔；")])]),a("li",[a("p",[t._v("B. 40% 的人会描述为："),a("code",[t._v("3 -> 3,3,3")]),t._v("，即第 1 个 3 直接输出，1 秒之后，连续输出 3 个 3。")])])]),a("p",[t._v("循环执行过程中，几乎同时设置了 3 个定时器，这些定时器都会在 1 秒之后触发，而循环完的输出是立即执行的，显而易见，正确的描述是 B。")]),a("p",[t._v("上面这个题目的参考链接：")]),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://juejin.im/post/58cf180b0ce4630057d6727c",target:"_blank",rel:"noopener noreferrer"}},[t._v("80% 应聘者都不及格的 JS 面试题")])])]),a("li",[a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/26229293",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入浅出Javascript事件循环机制(上)")])])])])])}],!1,null,null,null);s.default=o.exports}}]);